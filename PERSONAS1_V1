CREATE DATABASE actividad1;

\c actividad1

CREATE TABLE PERSONAS1 (
    RUT BIGINT,
    Nombre VARCHAR(50),
    Edad SMALLINT CHECK (Edad >= 0 AND Edad <= 99),
    Direccion VARCHAR(100)
);

COPY PERSONAS1 (RUT, Nombre, Edad, Direccion)
FROM '/home/kutty/Descargas/diezmil_sin_espacios.csv'
DELIMITER '|';  ---> SE USÒ FUNCIÒN SED PARA QUITAR ESPACIOS DEL ARCHIVO 'DIEZMIL'

\timing on                      
SELECT COUNT(*) FROM PERSONAS1;

\timing                      
SELECT COUNT(*) FROM PERSONAS1; 

CREATE INDEX personas1_rut_index ON PERSONAS1 (RUT);
Time: 71,263 ms ---- Time: 24,017 ms


CREATE TABLE PERSONAS2 (
    RUT BIGINT PRIMARY KEY,
    Nombre VARCHAR(50),
    Edad SMALLINT,
    Direccion VARCHAR(100)
);

COPY PERSONAS2 (RUT, Nombre, Edad, Direccion)
FROM '/home/kutty/Descargas/diezmil_sin_espacios.csv'
DELIMITER '|';
ERROR:  duplicate key value violates unique constraint "personas2_pkey"
DETAIL:  Key (rut)=(6551137333) already exists.
CONTEXT:  COPY personas2, line 3888



awk '!seen[$0]++' archivo.csv > archivo_sin_duplicados.csv

$ 200~awk '!seen[$0]++' diezmil_sin_espacios.cvs > diezmil_sin_duplicados.csv;
200~awk: orden no encontrada




\q

mv /home/richard/Escritorio/diezmil /tmp/    --// SE MUEVE A TMP YA QUE ESTA CARPETA TIENE LOS PERMISOS ADECUADOS 

COPY PERSONAS1 (RUT, Nombre, Edad, Direccion) FROM '/tmp/diezmil' DELIMITER '|';

-rwxr-xr-x 1 postgres postgres 1714900 mar 14 17:55 diezmil


chmod +r /home/richard/Escritorio/act1/diezmil


