
CREATE TABLE ruts (RUT BIGINT);

\COPY ruts (RUT) FROM '/tmp/50mil' DELIMITER ','; ---- meter ruts a tabla

Select nombre,direccion from personas1 where rut=(Select rut from ruts limit 1);

Select nombre,direccion from personas1 where rut= 88901377;

COPY (
Select nombre,direccion from personas1 where rut=(Select rut from ruts) 
) TO '/tmp/ResultadoP2.csv' WITH CSV HEADER;
-- al intentar este codgio se genera un error de que existe mas de una fila en la expresion --

COPY (
    SELECT personas1.nombre, personas1.direccion 
    FROM personas1 
    JOIN ruts ON personas1.rut = ruts.rut
) TO '/tmp/ResultadoP2.csv' WITH CSV HEADER;


